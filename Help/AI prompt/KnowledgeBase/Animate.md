[TOC]
## Definition
Namespace: [`My.Sys.Forms`](My.Sys.Forms.md)

`Animate` - `Animate` is a Control within the MyFbFramework, part of the freeBasic framework. <br> `Animate` - An animate control is a window that displays an Audio-Video Interleaved (AVI) clip.

## Properties
|Name|Description|
| :------------ | :------------ |
|[`Align`]("Control.Align.md")|Returns/sets which control borders are docked to its parent control and determines how a control is resized with its parent (Windows, Linux, Android, Web).|
|[`AllowDrop`]("Control.AllowDrop.md")|Gets or sets a value indicating whether the control can accept data that the user drags onto it (Windows, Linux).|
|[`Anchor`]("Control.Anchor.md")|Returns/sets the edges of the container to which a control is bound and determines how a control is resized with its parent (Windows, Linux, Android, Web).|
|[`AutoPlay`]("Animate.AutoPlay.md")||
|[`AutoSize`]("Animate.AutoSize.md")||
|[`BackColor`]("Control.BackColor.md")|Returns/sets the background color used to display text and graphics in an object (Windows, Linux, Web).|
|[`Balance`]("Animate.Balance.md")||
|[`BorderStyle`]("Control.BorderStyle.md")|Returns/sets the border style for an object (Windows, Linux).|
|[`Canvas`]("Control.Canvas.md")|Canvas is all about drawing in a container (Windows, Linux).|
|[`Center`]("Animate.Center.md")||
|[`CommonAvi`]("Animate.CommonAvi.md")||
|[`Constraints`]("Control.Constraints.md")|Specifies the size constraints for the control (Windows, Linux, Android, Web).|
|[`ContextMenu`]("Control.ContextMenu.md")|Returns/sets the PopupMenu associated with this control (Windows, Linux).|
|[`ControlIndex`]("Control.ControlIndex.md")|Returns/sets the object's index within the parent object's children collection (Windows, Linux, Android, Web).|
|[`Controls`]("Control.Controls.md")|Gets the collection of controls contained within the control (Windows, Linux, Android, Web).|
|[`Current`]("Control.Current.md")|Returns/sets the coordinates of the upper-left corner of the text layout relative to the upper-left corner of its container (Windows only).|
|[`Cursor`]("Control.Cursor.md")|Returns/sets the type of mouse pointer displayed when over part of an object (Windows, Linux).|
|[`Designer`]("My.Sys.Object.Designer.md")|Returns/sets the object that enables you to access the design characteristics of a object (Windows, Linux, Android, Web).|
|[`DesignMode`]("Component.DesignMode.md")|Gets a value that indicates whether the Component is currently in design mode (Windows, Linux, Android, Web).|
|[`DoubleBuffered`]("Control.DoubleBuffered.md")|Gets or sets a value indicating whether this control should redraw its surface using a secondary buffer to reduce or prevent flicker (Windows only)|
|[`Enabled`]("Control.Enabled.md")|Returns/sets a value that determines whether an object can respond to user-generated events (Windows, Linux).|
|[`ExtraMargins`]("Component.ExtraMargins.md")|Returns/sets the extra space between controls (Windows, Linux, Android, Web).|
|[`File`]("Animate.File.md")||
|[`Font`]("Control.Font.md")|Returns a Font object (Windows, Linux, Web).|
|[`ForeColor`]("Control.ForeColor.md")|Returns/sets the foreground color used to display text and graphics in an object (Windows, Web).|
|[`FrameHeight`]("Animate.FrameHeight.md")||
|[`FrameWidth`]("Animate.FrameWidth.md")||
|[`FullScreenMode`]("Animate.FullScreenMode.md")||
|[`Grouped`]("Control.Grouped.md")|Returns/sets the value indicating the first control of a group of controls (Windows only).|
|[`Handle`]("Component.Handle.md")|Gets the window handle that the control is bound to (Windows, Linux, Android, Web).|
|[`Height`]("Component.Height.md")|Returns/sets the height of an object (Windows, Linux, Android, Web).|
|[`HelpContext`]("Control.HelpContext.md")|Specifies the default Help file context ID for an object (Windows only).|
|[`Hint`]("Control.Hint.md")|Returns/sets the text displayed when the mouse is paused over the control (Windows, Linux).|
|[`HoverTime`]("Control.HoverTime.md")|Determines the time interval, after which the element, over which the mouse cursor hovers, is highlighted (Windows, Linux).|
|[`ID`]("Control.ID.md")|Gets or sets the programmatic identifier assigned to the control (Windows, Android).|
|[`IsChild`]("Control.IsChild.md")|Determines whether a window is a child window or descendant window of a specified parent window (Windows, Linux).|
|[`LayoutHandle`]("Component.LayoutHandle.md")||
|[`Left`]("Component.Left.md")|Returns/sets the distance between the internal left edge of an object and the left edge of its container (Windows, Linux, Android, Web).|
|[`Location`]("Control.Location.md")|Returns/sets the coordinates of the upper-left corner of the control relative to the upper-left corner of its container (Windows, Linux, Android, Web).|
|[`Margins`]("Component.Margins.md")|Returns/sets the space between controls (Windows, Linux, Android, Web).|
|[`Name`]("Component.Name.md")|Returns the name used in code to identify an object (Windows, Linux, Android, Web).|
|[`Parent`]("Control.Parent.md")|Returns/sets the parent container of the control (Windows, Linux, Android, Web).|
|[`Position`]("Animate.Position.md")||
|[`Rate`]("Animate.Rate.md")||
|[`RatioFixed`]("Animate.RatioFixed.md")||
|[`Repeat`]("Animate.Repeat.md")||
|[`ShowCaption`]("Control.ShowCaption.md")|Returns/sets the value indicating show Caption. (Windows only).|
|[`ShowHint`]("Control.ShowHint.md")|Returns/sets the value indicating show hint (Windows, Linux).|
|[`Size`]("Control.Size.md")|Returns/sets the height and width of the control (Windows, Linux, Android, Web).|
|[`StartFrame`]("Animate.StartFrame.md")||
|[`StopFrame`]("Animate.StopFrame.md")||
|[`SubClass`]("Control.SubClass.md")|Returs/sets a value indicating type is subclass or not (Windows only).|
|[`Tag`]("Component.Tag.md")|Stores any extra data needed for your program (Windows, Linux, Android, Web).|
|[`Text`]("Control.Text.md")|Returns/sets the text contained in the control (Windows, Linux, Android, Web).|
|[`Timers`]("Animate.Timers.md")||
|[`Top`]("Component.Top.md")|Returns/sets the distance between the internal top edge of an object and the top edge of its container (Windows, Linux, Android, Web).|
|[`Transparency`]("Animate.Transparency.md")||
|[`Visible`]("Control.Visible.md")|Returns/sets a value that determines whether an object is visible or hidden (Windows, Linux, Web).|
|[`Volume`]("Animate.Volume.md")||
|[`Width`]("Component.Width.md")|Returns/sets the width of an object (Windows, Linux, Android, Web).|
|[`xdpi`]("My.Sys.Object.xdpi.md")|Horizontal DPI scaling factor (Windows, Linux, Android, Web).|
|[`ydpi`]("My.Sys.Object.ydpi.md")|Vertical DPI scaling factor (Windows, Linux, Android, Web).|

## Methods
|Name|Description|
| :------------ | :------------ |
|[`Add`]("Control.Add.md")|Adds the specified control to the control collection (Windows, Linux, Android, Web).|
|[`AddRange`]("Control.AddRange.md")|Adds the specified controls range to the control collection (Windows, Linux, Android, Web).|
|[`BringToFront`]("Control.BringToFront.md")|Brings the control to the front of the z-order (Windows, Linux).|
|[`ClassAncestor`]("Component.ClassAncestor.md")|Returns ancestor class of control (Windows, Linux, Android, Web).|
|[`ClassName`]("My.Sys.Object.ClassName.md")|Used to get correct class name of the object (Windows, Linux, Android, Web).|
|[`ClientHeight`]("Control.ClientHeight.md")|Returns/sets the height of the client area of the control (Windows, Linux, Android, Web).|
|[`ClientToScreen`]("Control.ClientToScreen.md")|Converts the client-area coordinates of a specified point to screen coordinates (Windows only).|
|[`ClientWidth`]("Control.ClientWidth.md")|Returns/sets the width of the client area of the control (Windows, Linux, Android, Web).|
|[`Close`]("Animate.Close.md")|Releases AVI resources|
|[`ControlByName`]("Control.ControlByName.md")|Retrieves the Control object from Control name in the collection (Windows, Linux, Android, Web).|
|[`ControlCount`]("Control.ControlCount.md")|Gets the number of controls in the Control collection (Windows, Linux, Android, Web).|
|[`CreateWnd`]("Control.CreateWnd.md")|Creates the window (Windows, Android, Web)|
|[`DrawGif`]("Animate.DrawGif.md")|Renders GIF animation (if supported)|
|[`Focused`]("Control.Focused.md")|Returns a value indicating whether the control has input focus (Windows, Linux).|
|[`FrameCount`]("Animate.FrameCount.md")|Returns total number of frames|
|[`FrameHeightOriginal`]("Animate.FrameHeightOriginal.md")|Current displayed frame height in pixels|
|[`FrameWidthOriginal`]("Animate.FrameWidthOriginal.md")|Current displayed frame width in pixels|
|[`FreeWnd`]("Control.FreeWnd.md")|Destroys the specified window handle (Windows, Linux).|
|[`FullTypeName`]("My.Sys.Object.FullTypeName.md")|Function to get any typename in the inheritance up hierarchy of the type of an instance (address: 'po') compatible with the built-in 'Object' <br>  ('baseIndex =  0' to get the typename of the instance) <br>  ('baseIndex = -1' to get the base.typename of the instance, or "" if not existing) <br>  ('baseIndex = -2' to get the base.base.typename of the instance, or "" if not existing)|
|[`GetBounds`]("Component.GetBounds.md")|Gets the bounds of the control to the specified location and size (Windows, Linux, Android, Web).|
|[`GetErrorInfo`]("Animate.GetErrorInfo.md")|Retrieves last error details|
|[`GetForm`]("Control.GetForm.md")|Retrieves the form that the control is on (Windows, Linux, Android, Web).|
|[`GetTextLength`]("Control.GetTextLength.md")|Determines the length, in characters, of the text associated with a window (Windows, Linux, Android, Web).|
|[`GetTopLevel`]("Component.GetTopLevel.md")|Determines if the control is a top-level control (Windows, Linux, Android, Web).|
|[`Hide`]("Control.Hide.md")|Conceals the control from the user (Windows, Linux, Android, Web).|
|[`IndexOf`]("Control.IndexOf.md")|Retrieves the index of a specified Control object in the collection (Windows, Linux, Android, Web).|
|[`Invalidate`]("Control.Invalidate.md")|Invalidates the entire surface of the control and causes the control to be redrawn (Windows only).|
|[`IsEmpty`]("My.Sys.Object.IsEmpty.md")|Returns a Boolean value indicating whether a object has been initialized (Windows, Linux, Android, Web).|
|[`IsPlaying`]("Animate.IsPlaying.md")|Checks if playback is active|
|[`OpenFile`]("Animate.OpenFile.md")|Loads AVI from file path|
|[`OpenMode`]("Animate.OpenMode.md")|Specifies file access mode|
|[`Pause`]("Animate.Pause.md")|Temporarily halts playback|
|[`Play`]("Animate.Play.md")|Starts video playback|
|[`ProcessMessage`]("Control.ProcessMessage.md")||
|[`Ratio`]("Animate.Ratio.md")|Scaling factor for video display|
|[`ReadProperty`]("Animate.ReadProperty.md")|Loads persisted properties|
|[`RecreateWnd`]("Control.RecreateWnd.md")|Recreates the window (Windows only)|
|[`Remove`]("Control.Remove.md")|Removes the specified control from the control collection (Windows, Linux, Android, Web).|
|[`Repaint`]("Control.Repaint.md")|Forces the control to invalidate its client area and immediately redraw itself and any child controls (Windows, Linux).|
|[`RequestAlign`]("Control.RequestAlign.md")|Instructs the parent of a control to reposition the control, enforcing its Align property (Windows, Linux, Android, Web).|
|[`ScaleX`]("My.Sys.Object.ScaleX.md")|Applies horizontal DPI scaling|
|[`ScaleY`]("My.Sys.Object.ScaleY.md")|Applies vertical DPI scaling|
|[`ScreenToClient`]("Control.ScreenToClient.md")|Converts the screen coordinates of a specified point on the screen to client coordinates (Windows only).|
|[`SelectNextControl`]("Control.SelectNextControl.md")|Activates the next control (Windows only).|
|[`SendToBack`]("Control.SendToBack.md")|Sends the control to the back of the z-order (Windows, Linux).|
|[`SetBounds`]("Component.SetBounds.md")|Sets the bounds of the control to the specified location and size (Windows, Linux, Android, Web).|
|[`SetFocus`]("Control.SetFocus.md")|Moves the focus to the specified form or the specified control on the active form (Windows, Linux).|
|[`SetMargins`]("Control.SetMargins.md")|Sets the left, top, right, bottom margins for a container control (Windows, Linux, Android, Web).|
|[`SetMoviePosition`]("Animate.SetMoviePosition.md")|Seeks to specific time position|
|[`Show`]("Control.Show.md")|Displays the control to the user (Windows, Linux, Android, Web).|
|[`Stop`]("Animate.Stop.md")|Stops and resets playback|
|[`TopLevelControl`]("Control.TopLevelControl.md")|Returns the parent control that is not parented by another Forms control. Typically, this is the outermost Form that the control is contained in (Windows, Linux, Android, Web).|
|[`ToString`]("Component.ToString.md")|Returns a string that represents the current object (Windows, Linux, Android, Web).|
|[`UnScaleX`]("My.Sys.Object.UnScaleX.md")|Reverses horizontal scaling|
|[`UnScaleY`]("My.Sys.Object.UnScaleY.md")|Reverses vertical scaling|
|[`Update`]("Control.Update.md")|Causes the control to redraw the invalidated regions within its client area (Windows, Linux).|
|[`UpdateLock`]("Control.UpdateLock.md")|Disables drawing in the specified window (Windows only).|
|[`UpdateUnLock`]("Control.UpdateUnLock.md")|Enables drawing in the specified window (Windows only).|
|[`WriteProperty`]("Animate.WriteProperty.md")|Persists properties to storage|
## Events
|Name|Description|
| :------------ | :------------ |
|[`OnClick`]("Control.OnClick.md") |Occurs when the control is clicked (Windows, Linux, Android, Web).|
|[`OnClose`]("Animate.OnClose.md") |Raised when AVI resources are released|
|[`OnCreate`]("Control.OnCreate.md") |Occurs when the control is created (Windows, Linux, Android, Web).|
|[`OnDblClick`]("Control.OnDblClick.md") |Occurs when the control is double-clicked (Windows, Linux, Web).|
|[`OnDestroy`]("Control.OnDestroy.md") |Occurs when the control's handle is in the process of being destroyed (Windows, Linux, Android, Web).|
|[`OnDropFile`]("Control.OnDropFile.md") |Occurs when the user drops a file on the window of an application that has registered itself as a recipient of dropped files (Windows, Linux).|
|[`OnGotFocus`]("Control.OnGotFocus.md") |Occurs when the control receives focus (Windows, Linux, Web).|
|[`OnKeyDown`]("Control.OnKeyDown.md") |Occurs when a key is pressed while the control has focus (Windows, Linux, Web).|
|[`OnKeyPress`]("Control.OnKeyPress.md") |Occurs when a character. space or backspace key is pressed while the control has focus (Windows, Linux, Web).|
|[`OnKeyUp`]("Control.OnKeyUp.md") |Occurs when a key is released while the control has focus (Windows, Linux, Web).|
|[`OnLostFocus`]("Control.OnLostFocus.md") |Occurs when the control loses focus (Windows, Linux, Web).|
|[`OnMessage`]("Control.OnMessage.md") |Occurs when the window receives a message (Windows, Linux).|
|[`OnMouseDown`]("Control.OnMouseDown.md") |Occurs when the mouse pointer is over the control and a mouse button is pressed (Windows, Linux, Web).|
|[`OnMouseEnter`]("Control.OnMouseEnter.md") |Occurs when the mouse pointer enters the control (Windows, Linux, Web).|
|[`OnMouseHover`]("Control.OnMouseHover.md") |Occurs when the mouse pointer rests on the control (Windows only).|
|[`OnMouseLeave`]("Control.OnMouseLeave.md") |Occurs when the mouse pointer leaves the control (Windows, Linux, Web).|
|[`OnMouseMove`]("Control.OnMouseMove.md") |Occurs when the mouse pointer is moved over the control (Windows, Linux, Web).|
|[`OnMouseUp`]("Control.OnMouseUp.md") |Occurs when the mouse pointer is over the control and a mouse button is released (Windows, Linux, Web).|
|[`OnMouseWheel`]("Control.OnMouseWheel.md") |Occurs when the mouse wheel moves while the control has focus (Windows, Linux, Web).|
|[`OnMove`]("Control.OnMove.md") |Occurs when the control is moved (Windows, Linux).|
|[`OnOpen`]("Animate.OnOpen.md") |Triggered after AVI file loads|
|[`OnPaint`]("Control.OnPaint.md") |Occurs when the control is redrawn (Windows, Linux).|
|[`OnPause`]("Animate.OnPause.md") |Raised on playback pause|
|[`OnResize`]("Control.OnResize.md") |Occurs when the control is resized (Windows, Linux, Android).|
|[`OnScroll`]("Control.OnScroll.md") |Occurs when the scroll box has been moved by either a mouse or keyboard action (Windows, Linux).|
|[`OnStart`]("Animate.OnStart.md") |Triggered when playback begins|
|[`OnStop`]("Animate.OnStop.md") |Raised when playback stops|
## Examples
```freeBasic
'################################################################################
'#  Animate Example.frm                                                           #
'#  This file is an examples of MyFBFramework                                   #
'#  Authors: Xusinboy Bekchanov, Liu XiaLin                                     #
'################################################################################

'\#Region "Form"
	\#define GIFPlayOn
	\#define MoviePlayOn
	\#if defined(__FB_MAIN__) AndAlso Not defined(__MAIN_FILE__)
		\#ifdef __FB_WIN32__
			'\#cmdline "AnimatePlayer.rc"
		\#endif
		\#define __MAIN_FILE__ __FILE__
	\#endif
	\#include once "mff/Form.bi"
	\#include once "mff/sys.bi"
	\#include once "mff/CommandButton.bi"
	\#include once "mff/Panel.bi"
	\#include once "mff/ImageBox.bi"
	\#include once "mff/TextBox.bi"
	\#include once "mff/TrackBar.bi"
	\#include once "mff/Label.bi"
	\#include once "mff/Dialogs.bi"
	\#include once "mff/Picture.bi"
	\#include once "mff/TimerComponent.bi"
	\#include once "mff/ComboBoxEdit.bi"
	\#include once "mff/ImageList.bi"
	\#include once "mff/ComboBoxEx.bi"
	\#include once "mff/CheckBox.bi"
	\#include once "mff/Animate.bi"
	\#include once "string.bi"
	
	Using My.Sys.Forms
	
	Dim Shared As Double Duration
	
	Private Function Sec2Time(Sec As Single, hfmt As String = "#,#0", mfmt As String = "#00", sfmt As String = "#00") ByRef As String
		Dim h As Long
		Dim m As Long
		Dim s As Single
		Static r As String
		h = Sec \ 3600
		m = (Sec - h * 3600) \ 60
		s = Sec - h * 3600 - m * 60
		r = Format(h, hfmt) & ":" & Format(m, mfmt) & ":" & Format(s, sfmt)
		Return r
	End Function
	
	Type frmAnimateType Extends Form
		Declare Sub cboFileName_DblClick(ByRef Sender As Control)
		Declare Sub Form_Create(ByRef Sender As Control)
		Declare Sub Form_Close(ByRef Sender As Form, ByRef Action As Integer)
		Declare Sub cmdBtn_Click(ByRef Sender As Control)
		Declare Sub Form_Resize(ByRef Sender As Control, NewWidth As Integer, NewHeight As Integer)
		Declare Sub tbAudio_Change(ByRef Sender As TrackBar, Position As Integer)
		Declare Sub tbAudio_MouseUp(ByRef Sender As Control, MouseButton As Integer, x As Integer, y As Integer, Shift As Integer)
		Declare Sub tbBalance_Change(ByRef Sender As TrackBar, Position As Integer)
		Declare Sub tbBalance_MouseUp(ByRef Sender As Control, MouseButton As Integer, x As Integer, y As Integer, Shift As Integer)
		Declare Sub TimerComponent1_Timer(ByRef Sender As TimerComponent)
		Declare Sub tbPosition_Change(ByRef Sender As TrackBar, Position As Integer)
		Declare Sub tbPosition_MouseDown(ByRef Sender As Control, MouseButton As Integer, x As Integer, y As Integer, Shift As Integer)
		Declare Sub tbPosition_MouseUp(ByRef Sender As Control, MouseButton As Integer, x As Integer, y As Integer, Shift As Integer)
		Declare Sub Animate1_Message(ByRef Sender As Control, ByRef MSG As Message)
		Declare Sub cboChanel_Selected(ByRef Sender As ComboBoxEdit, ItemIndex As Integer)
		Declare Sub cmdBrowse_Click(ByRef Sender As Control)
		Declare Sub cmdFull_Click(ByRef Sender As Control)
		Declare Sub chkLoop_Click(ByRef Sender As CheckBox)
		Declare Sub cmdRate_Click(ByRef Sender As Control)
		Declare Sub chkRatio_Click(ByRef Sender As CheckBox)
		Declare Constructor
		
		Dim As Panel PanelControl, PanelPosition
		Dim As CommandButton cmdOpen, cmdPlay, cmdClose, cmdFull(3), cmdBrowse, cmdRate(1)
		Dim As ComboBoxEdit cboFileName
		Dim As TrackBar tbVolume, tbBalance, tbPosition
		Dim As Label lblVolume, lblBalance, lblLength, lblPosition
		Dim As OpenFileDialog OpenFileDialog1
		Dim As TimerComponent TimerComponent1
		Dim As CheckBox chkLoop, chkRatio
		Dim As Animate Animate1
	End Type
	
	Constructor frmAnimateType
		\#if _MAIN_FILE_ = __FILE__
			With App
				.CurLanguagePath = ExePath & "/Languages/"
				.CurLanguage = My.Sys.Language
				Print  "CurLanguage =" & .CurLanguage 
			End With
		\#endif

		' frmAnimate
		With This
			.Name = "frmAnimate"
			.Text = ML("VisualFBEditor Animate Player")
			\#ifdef __FB_64BIT__
				.Caption = ML("VisualFBEditor Animate Player(X64)")
			\#else
				.Caption = ML("VisualFBEditor Animate Player(X32)")
			\#endif
			.Designer = @This
			.OnCreate = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As Control), @Form_Create)
			.OnClose = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As Form, ByRef Action As Integer), @Form_Close)
			.OnResize = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As Control, NewWidth As Integer, NewHeight As Integer), @Form_Resize)
			.StartPosition = FormStartPosition.CenterScreen
			.BackColor = 8421376
			.SetBounds 0, 0, 800, 480
		End With
		' Animate1
		With Animate1
			.Name = "Animate1"
			.Text = "Animate1"
			.AutoSize = True
			.Center = True
			.Transparency = True
			'.FILE = "D:\Faster (2010) 720p BluRay AC3 x264 - AdiT.mkv"
			'.FILE = "ExePath & "/../Resources/horse.gif"
			.BackColor = 16776960
			.Anchor.Top = AnchorStyle.asAnchor
			.Anchor.Right = AnchorStyle.asAnchor
			.Anchor.Left = AnchorStyle.asAnchor
			.Anchor.Bottom = AnchorStyle.asAnchor
			.SetBounds 0, 25, 785, 375
			.OnMessage = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As Control, ByRef MSG As Message), @Animate1_Message)
			.SendToBack
			.Designer = @This
			.Parent = @This
		End With
		' PanelPosition
		With PanelPosition
			.Name = "PanelPosition"
			.Text = "PanelPosition"
			.TabIndex = 0
			.Align = DockStyle.alBottom
			.Anchor.Left = AnchorStyle.asAnchor
			.Anchor.Right = AnchorStyle.asAnchor
			.Anchor.Top = AnchorStyle.asNone
			.ControlIndex = 0
			.Location = Type<My.Sys.Drawing.Point>(0, 415)
			.SetBounds 0, 415, 789, 50
			.BringToFront
			.Parent = @This
		End With
		' PanelControl
		With PanelControl
			.Name = "PanelControl"
			.Text = "PanelControl"
			.TabIndex = 0
			.Align = DockStyle.alTop
			.SetBounds 10, 0, 789, 26
			.Parent = @This
		End With
		' cmdOpen
		With cmdOpen
			.Name = "cmdOpen"
			.Text = ML("Open")
			.TabIndex = 6
			.SetBounds 8, 2, 50, 20
			.Designer = @This
			.OnClick = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As Control), @cmdBtn_Click)
			.Parent = @PanelControl
		End With
		' cmdPlay
		With cmdPlay
			.Name = "cmdPlay"
			.Text = ML("Play")
			.TabIndex = 7
			.Enabled = False
			.SetBounds 59, 2, 50, 20
			.Designer = @This
			.OnClick = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As Control), @cmdBtn_Click)
			.Parent = @PanelControl
		End With
		' cmdClose
		With cmdClose
			.Name = "cmdClose"
			.Text = ML("Close")
			.TabIndex = 9
			.ControlIndex = 4
			.Enabled = False
			.SetBounds 110, 2, 50, 20
			.Designer = @This
			.OnClick = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As Control), @cmdBtn_Click)
			.Parent = @PanelControl
		End With
		' cmdFull(0)
		With cmdFull(0)
			.Name = "cmdFull(0)"
			.Text = ML("Full")
			.TabIndex = 10
			.Enabled = False
			.SetBounds 170, 2, 20, 20
			.Designer = @This
			.OnClick = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As Control), @cmdBtn_Click)
			.Parent = @PanelControl
		End With
		' cboFileName
		With cboFileName
			.Name = "cboFileName"
			.Text = "../Resources/horse.gif"
			.Hint = ML("Double click to select a file from local disk.")
			.TabIndex = 12
			.Style = cbDropDown
			.Align = DockStyle.alNone
			.ExtraMargins.Right = 10
			.ExtraMargins.Left = 10
			.ExtraMargins.Top = 10
			.ExtraMargins.Bottom = 10
			.Anchor.Left = AnchorStyle.asAnchor
			.Anchor.Right = AnchorStyle.asAnchor
			.SetBounds 260, 2, 489, 16
			.Designer = @This
			.OnDblClick = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As Control), @cboFileName_DblClick)
			.Parent = @PanelControl
		End With
		
		' lblVolume
		With lblVolume
			.Name = "lblVolume"
			.Text = ML("Volume:")
			.TabIndex = 14
			.Alignment = AlignmentConstants.taLeft
			.Align = DockStyle.alNone
			.ID = 1004
			.Enabled = False
			.SetBounds 10, 2, 110, 16
			.Parent = @PanelPosition
		End With
		' tbVolume
		With tbVolume
			.Name = "tbVolume"
			.Text = "tbVolume"
			.TabIndex = 15
			.ExtraMargins.Left = 2
			.MaxValue = 0
			.MinValue = -100
			.Position = 0
			.Enabled = False
			.ThumbLength = 20
			.TickStyle = TickStyles.tsAuto
			.ID = 1004
			.TickMark = TickMarks.tmTopLeft
			.Frequency = 10
			.PageSize = 10
			.SetBounds 0, 16, 110, 30
			.Designer = @This
			.OnChange = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As TrackBar, Position As Integer), @tbAudio_Change)
			.OnMouseUp = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As Control, MouseButton As Integer, x As Integer, y As Integer, Shift As Integer), @tbAudio_MouseUp)
			.Parent = @PanelPosition
		End With
		' lblBalance
		With lblBalance
			.Name = "lblBalance"
			.Text = ML("Balance:")
			.TabIndex = 16
			.Alignment = AlignmentConstants.taLeft
			.Enabled = False
			.SetBounds 120, 2, 110, 16
			.Parent = @PanelPosition
		End With
		' tbBalance
		With tbBalance
			.Name = "tbBalance"
			.Text = "tbBalance"
			.TabIndex = 16
			.MaxValue = 50
			.MinValue = -50
			.Enabled = False
			.TickStyle = TickStyles.tsAuto
			.ID = 1004
			.TickMark = TickMarks.tmTopLeft
			.Style = TrackBarOrientation.tbHorizontal
			.SubClass = True
			.Frequency = 10
			.PageSize = 10
			.SetBounds 110, 16, 110, 30
			.Designer = @This
			.OnChange = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As TrackBar, Position As Integer), @tbAudio_Change)
			.OnMouseUp = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As Control, MouseButton As Integer, x As Integer, y As Integer, Shift As Integer), @tbAudio_MouseUp)
			.Parent = @PanelPosition
		End With
		' lblPosition
		With lblPosition
			.Name = "lblPosition"
			.Text = ML("Position:")
			.TabIndex = 17
			.Enabled = False
			.Designer = @This
			.SetBounds 280, 2, 220, 16
			.Parent = @PanelPosition
		End With
		' lblLength
		With lblLength
			.Name = "lblLength"
			.Text = ML("Length:")
			.TabIndex = 18
			.Enabled = False
			.Designer = @This
			.Anchor.Right = AnchorStyle.asAnchor
			.Location = Type<My.Sys.Drawing.Point>(677, 2)
			.SetBounds 677, 2, 100, 15
			.Parent = @PanelPosition
		End With
		' tbPosition
		With tbPosition
			.Name = "tbPosition"
			.Text = "tbPosition"
			.TabIndex = 19
			.Align = DockStyle.alNone
			.PageSize = 10
			.MaxValue = 100
			.TickMark = TickMarks.tmBoth
			.TickStyle = TickStyles.tsAuto
			.ThumbLength = 20
			.ID = 1002
			.LineSize = 10
			.Frequency = 10
			.Style = TrackBarOrientation.tbHorizontal
			.Enabled = False
			.Anchor.Right = AnchorStyle.asAnchor
			.Anchor.Left = AnchorStyle.asAnchor
			.Anchor.Bottom = AnchorStyle.asNone
			.Anchor.Top = AnchorStyle.asNone
			.SetBounds 270, 16, 488, 20
			.Designer = @This
			.OnChange = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As TrackBar, Position As Integer), @tbPosition_Change)
			.OnMouseDown = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As Control, MouseButton As Integer, x As Integer, y As Integer, Shift As Integer), @tbPosition_MouseDown)
			.OnMouseUp = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As Control, MouseButton As Integer, x As Integer, y As Integer, Shift As Integer), @tbPosition_MouseUp)
			.Parent = @PanelPosition
		End With
		' cmdRate(0)
		With cmdRate(0)
			.Name = "cmdRate(0)"
			.Text = "<<"
			.TabIndex = 20
			.SetBounds 250, 18, 22, 16
			.Designer = @This
			.OnClick = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As Control), @cmdRate_Click)
			.Parent = @PanelPosition
		End With
		
		' cmdRate(0)
		With cmdRate(1)
			.Name = "cmdRate(1)"
			.Text = ">>"
			.TabIndex = 24
			.Anchor.Right = AnchorStyle.asAnchor
			.SetBounds 760, 18, 22, 16
			.Designer = @This
			.OnClick = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As Control), @cmdRate_Click)
			.Parent = @PanelPosition
		End With
		' OpenFileDialog1
		With OpenFileDialog1
			.Name = "OpenFileDialog1"
			.SetBounds 0, 0, 16, 16
			.Designer = @This
			.Parent = @This
		End With
		' TimerComponent1
		With TimerComponent1
			.Name = "TimerComponent1"
			.Interval = 20
			.SetBounds 20, 0, 16, 16
			.Designer = @This
			.OnTimer = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As TimerComponent), @TimerComponent1_Timer)
			.Parent = @This
		End With
		' chkLoop
		With chkLoop
			.Name = "chkLoop"
			.Text = ML("Loop")
			.TabIndex = 19
			.Caption = ML("Loop")
			.Checked = True
			.Enabled = False
			.SetBounds 460, 1, 40, 16
			.Designer = @This
			.OnClick = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As Control), @chkLoop_Click)
			.Parent = @PanelPosition
		End With
		' cmdBrowse
		With cmdBrowse
			.Name = "cmdBrowse"
			.Text = "..."
			.TabIndex = 22
			.ControlIndex = 0
			.Align = DockStyle.alNone
			.Caption = "..."
			.Anchor.Right = AnchorStyle.asAnchor
			.SetBounds 750, 2, 29, 20
			.Designer = @This
			.OnClick = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As Control), @cmdBrowse_Click)
			.Parent = @PanelControl
		End With
		' cmdFull(1)
		With cmdFull(1)
			.Name = "cmdFull(1)"
			.Text = "1X"
			.TabIndex = 21
			.ControlIndex = 3
			.Enabled = False
			.Caption = "1X"
			.SetBounds 190, 2, 20, 20
			.Designer = @This
			.OnClick = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As Control), @cmdFull_Click)
			.Parent = @PanelControl
		End With
		' cmdFull(2)
		With cmdFull(2)
			.Name = "cmdFull(2)"
			.Text = "2X"
			.TabIndex = 22
			.ControlIndex = 4
			.Enabled = False
			.OnClick = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As Control), @cmdFull_Click)
			.Caption = "2X"
			.SetBounds 210, 2, 20, 20
			.Designer = @This
			.Parent = @PanelControl
		End With
		' cmdFull(3)
		With cmdFull(3)
			.Name = "cmdFull(3)"
			.Text = "3X"
			.TabIndex = 23
			.ControlIndex = 6
			.Enabled = False
			.Caption = "3X"
			.SetBounds 230, 2, 20, 20
			.Designer = @This
			.OnClick = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As Control), @cmdFull_Click)
			.Parent = @PanelControl
		End With
		
		' chkRatio
		With chkRatio
			.Name = "chkRatio"
			.Text = ML("Ratio Fixed")
			.TabIndex = 22
			.ControlIndex = 9
			.Checked = True
			.Enabled = False
			.SetBounds 520, 1, 80, 16
			.Designer = @This
			.OnClick = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As Control), @chkRatio_Click)
			.Parent = @PanelPosition
		End With
	End Constructor
	
	Dim Shared frmAnimate As frmAnimateType
	
	\#if __MAIN_FILE__ = __FILE__
		App.DarkMode = True
		frmAnimate.Show
		App.Run
	\#endif
'\#End Region

Private Sub frmAnimateType.cboFileName_DblClick(ByRef Sender As Control)
	If OpenFileDialog1.Execute() Then
		cboFileName.Text = OpenFileDialog1.FileName
		cmdPlay.SetFocus
	End If
End Sub

Private Sub frmAnimateType.Form_Create(ByRef Sender As Control)
	
	If Dir(ExePath & "\PlayList.txt") <> "" Then
		cboFileName.LoadFromFile(ExePath & "\PlayList.txt")
		cboFileName.ItemIndex = cboFileName.ItemCount - 1
	End If
End Sub

Private Sub frmAnimateType.Form_Close(ByRef Sender As Form, ByRef Action As Integer)
	Animate1.Close
End Sub

Private Sub frmAnimateType.Form_Resize(ByRef Sender As Control, NewWidth As Integer, NewHeight As Integer)
	
	This.Caption = Mid(This.Caption, 1, Len(ML("VisualFBEditor Animate Player(X64)")) + 1) & " - " & CLng(Animate1.FrameWidth) & "X" & (Animate1.FrameHeight)
	
End Sub

Private Sub frmAnimateType.cmdBtn_Click(ByRef Sender As Control)
	Dim b As Boolean = False
	Select Case Sender.Name
	Case "cmdOpen"
		Animate1.Close
		If ..Left(Trim(cboFileName.Text), 9) = "OS System" Then
			Animate1.CommonAvi = CommonAVIs.aviCopyFile 'Val(Trim(Mid(Trim(cboFileName.Text), 10))) 'CommonAVIs.aviCopyFile '
			Animate1.OpenFile
		Else
			If Animate1.OpenFile(cboFileName.Text) = 0 Then
				MsgBox("Open File failure!" & Chr(13, 10) & Animate1.GetErrorInfo)
				Exit Sub
			End If
		End If
		Duration = Animate1.FrameCount
		If Duration > 0 Then
			tbPosition.MaxValue = CInt(Duration)
			tbPosition.PageSize = CInt(Duration / 10)
			tbPosition.Frequency = CInt(Duration / 10)
			lblLength.Text = ML("Length:") & Sec2Time(Duration)
			lblLength.Enabled = True
			chkLoop.Enabled = True
			chkRatio.Enabled = True
			TimerComponent1.Enabled = True
		Else
			tbPosition.Enabled = False
			lblLength.Text = ML("Length: NA")
			lblLength.Enabled = False
			chkLoop.Enabled = False
			chkRatio.Enabled = False
		End If
		tbVolume.Position = Animate1.Volume
		lblVolume.Text = ML("Volume:") & tbVolume.Position
		tbBalance.Position = Animate1.Balance
		lblBalance.Text = ML("Balance:") & tbBalance.Position
		tbPosition.Position = 0
		'Animate1.Play
		cmdPlay.Text = ML("Pause")
		b = True
	Case "cmdPlay"
		Select Case Sender.Text
		Case "Play"
			cmdPlay.Text = ML("Pause")
			Animate1.Play
			TimerComponent1.Enabled = True
			b = True
		Case "Pause"
			cmdPlay.Text = ML("Play")
			Animate1.Pause
			TimerComponent1.Enabled = False
			b = True
		End Select
	Case "cmdClose"
		Animate1.Stop
		TimerComponent1.Enabled = False
		b = False
	Case "cmdFull(0)"
		Animate1.FullScreenMode = True
		Exit Sub
	Case Else
		Exit Sub
	End Select
	If Duration > 0 Then tbPosition.Enabled = True
	tbVolume.Enabled = b
	tbBalance.Enabled = b
	lblVolume.Enabled = b
	lblBalance.Enabled = b
	lblPosition.Enabled = b
	cmdPlay.Enabled = b
	cmdClose.Enabled = b
	cmdFull(0).Enabled = b
	cmdFull(1).Enabled = b
	cmdFull(2).Enabled = b
	cmdFull(3).Enabled = b
	cmdOpen.Enabled = Not b
	tbPosition.SetFocus
End Sub

Private Sub frmAnimateType.tbAudio_Change(ByRef Sender As TrackBar, Position As Integer)
	Select Case Sender.Name
	Case "tbVolume"
		Animate1.Volume= Position * 100
		lblVolume.Text = ML("Volume:") & Position
	Case "tbBalance"
		Animate1.Balance = Position * 100
		lblBalance.Text = ML("Balance:") & Animate1.Balance/ 100
	End Select
End Sub

Private Sub frmAnimateType.tbAudio_MouseUp(ByRef Sender As Control, MouseButton As Integer, x As Integer, y As Integer, Shift As Integer)
	Select Case Sender.Name
	Case "tbVolume"
		Animate1.Volume = tbVolume.Position * 100
		Debug.Print "Animate1.Volume=" & Animate1.Volume
	Case "tbBalance"
		Animate1.Balance= tbBalance.Position * 100
		Debug.Print "Animate1.Balance=" & Animate1.Balance
	End Select
End Sub

Private Sub frmAnimateType.tbPosition_Change(ByRef Sender As TrackBar, Position As Integer)
	If TimerComponent1.Enabled = True Then Exit Sub
	lblPosition.Text = ML("Position:") & Sec2Time(Position)
End Sub

Private Sub frmAnimateType.tbPosition_MouseDown(ByRef Sender As Control, MouseButton As Integer, x As Integer, y As Integer, Shift As Integer)
	If MouseButton = 0 Then
		TimerComponent1.Enabled = False
	End If
End Sub

Private Sub frmAnimateType.tbPosition_MouseUp(ByRef Sender As Control, MouseButton As Integer, x As Integer, y As Integer, Shift As Integer)
	If MouseButton = 0 AndAlso TimerComponent1.Enabled = False Then
		Animate1.Position = tbPosition.Position
		TimerComponent1.Enabled = True
	End If
End Sub

Private Sub frmAnimateType.TimerComponent1_Timer(ByRef Sender As TimerComponent)
	If tbPosition.Enabled Then
		Dim As Double Animate1Position = Animate1.Position
		If tbPosition.MaxValue - Animate1Position <= 1 AndAlso tbPosition.MaxValue > 2 Then
			If chkLoop.Checked Then
				Animate1.Position = 0 : Animate1Position = 0
			Else
				cmdBtn_Click(cmdPlay)
			End If
		End If
		tbPosition.Position = Animate1Position
		lblPosition.Text = ML("Position:") & Sec2Time(Animate1Position) & "  Play Rate: " & Animate1.Rate
	End If
End Sub

'https://learn.microsoft.com/en-us/windows/win32/directshow/event-notification-codes.
Private Sub frmAnimateType.Animate1_Message(ByRef Sender As Control, ByRef msg As Message)
	
End Sub

Private Sub frmAnimateType.cboChanel_Selected(ByRef Sender As ComboBoxEdit, ItemIndex As Integer)
	This.Caption = Mid(This.Caption, 1, Len(ML("VisualFBEditor Animate Player(X64)")) + 1)
End Sub

Private Sub frmAnimateType.cmdBrowse_Click(ByRef Sender As Control)
	If OpenFileDialog1.Execute() Then
		cboFileName.Text = OpenFileDialog1.FileName
		If cboFileName.Contains(OpenFileDialog1.FileName) = False Then
			cboFileName.AddItem OpenFileDialog1.FileName
			cboFileName.SaveToFile(ExePath & "\PlayList.txt")
		End If
		This.Caption = Mid(This.Caption, 1, Len(ML("VisualFBEditor Animate Player(X64)")) + 1)
		cmdPlay.SetFocus
	End If
End Sub

Private Sub frmAnimateType.cmdFull_Click(ByRef Sender As Control)
	Dim As Integer Index = Val(Mid(Sender.Name, InStrRev(Sender.Name, "(") + 1))
	If Index > 0 Then 'mVideoWidth, mVideoHeight
		Animate1.AutoSize = True
		Animate1.FrameWidth = Animate1.FrameWidthOriginal * Index : Animate1.FrameHeight = Animate1.FrameHeightOriginal * Index
		This.Caption = Mid(This.Caption, 1, Len(ML("VisualFBEditor Animate Player(X64)")))  & " - " & Animate1.FrameWidthOriginal * Index & "X" & Animate1.FrameHeightOriginal * Index
	End If
End Sub

Private Sub frmAnimateType.cmdRate_Click(ByRef Sender As Control)
	Dim As Integer Index = Val(Mid(Sender.Name, InStrRev(Sender.Name, "(") + 1))
	If Index = 1 Then
		Animate1.Rate= Animate1.Rate * 2
	Else
		Animate1.Rate= Animate1.Rate / 2
	End If
	If Abs(Animate1.Rate) >  32 OrElse Animate1.Rate< 0.06 Then Animate1.Rate= 1
End Sub


Private Sub frmAnimateType.chkLoop_Click(ByRef Sender As CheckBox)
	Animate1.Repeat = IIf(chkLoop.Checked, 1, 0)
End Sub

Private Sub frmAnimateType.chkRatio_Click(ByRef Sender As CheckBox)
	Animate1.RatioFixed = chkRatio.Checked
End Sub

```
## See also
Namespace: [`My.Sys.Forms`](My.Sys.Forms.md)
