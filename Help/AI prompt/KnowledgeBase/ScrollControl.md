[TOC]
## Definition
Namespace: [`My.Sys.Forms`](My.Sys.Forms.md)

`ScrollControl` - 

## Properties
|Name|Description|
| :------------ | :------------ |
|[`Align`]("Control.Align.md")|Returns/sets which control borders are docked to its parent control and determines how a control is resized with its parent (Windows, Linux, Android, Web).|
|[`AllowDrop`]("Control.AllowDrop.md")|Gets or sets a value indicating whether the control can accept data that the user drags onto it (Windows, Linux).|
|[`Anchor`]("Control.Anchor.md")|Returns/sets the edges of the container to which a control is bound and determines how a control is resized with its parent (Windows, Linux, Android, Web).|
|[`AutoSize`]("ContainerControl.AutoSize.md")|Determines whether a control is automatically resized to display its entire contents (Windows, Linux).|
|[`BackColor`]("Control.BackColor.md")|Returns/sets the background color used to display text and graphics in an object (Windows, Linux, Web).|
|[`BorderStyle`]("Control.BorderStyle.md")|Returns/sets the border style for an object (Windows, Linux).|
|[`Canvas`]("Control.Canvas.md")|Canvas is all about drawing in a container (Windows, Linux).|
|[`Constraints`]("Control.Constraints.md")|Specifies the size constraints for the control (Windows, Linux, Android, Web).|
|[`ContextMenu`]("Control.ContextMenu.md")|Returns/sets the PopupMenu associated with this control (Windows, Linux).|
|[`ControlIndex`]("Control.ControlIndex.md")|Returns/sets the object's index within the parent object's children collection (Windows, Linux, Android, Web).|
|[`Controls`]("Control.Controls.md")|Gets the collection of controls contained within the control (Windows, Linux, Android, Web).|
|[`Current`]("Control.Current.md")|Returns/sets the coordinates of the upper-left corner of the text layout relative to the upper-left corner of its container (Windows only).|
|[`Cursor`]("Control.Cursor.md")|Returns/sets the type of mouse pointer displayed when over part of an object (Windows, Linux).|
|[`Designer`]("My.Sys.Object.Designer.md")|Returns/sets the object that enables you to access the design characteristics of a object (Windows, Linux, Android, Web).|
|[`DesignMode`]("Component.DesignMode.md")|Gets a value that indicates whether the Component is currently in design mode (Windows, Linux, Android, Web).|
|[`DoubleBuffered`]("Control.DoubleBuffered.md")|Gets or sets a value indicating whether this control should redraw its surface using a secondary buffer to reduce or prevent flicker (Windows only)|
|[`Enabled`]("Control.Enabled.md")|Returns/sets a value that determines whether an object can respond to user-generated events (Windows, Linux).|
|[`ExtraMargins`]("Component.ExtraMargins.md")|Returns/sets the extra space between controls (Windows, Linux, Android, Web).|
|[`Font`]("Control.Font.md")|Returns a Font object (Windows, Linux, Web).|
|[`ForeColor`]("Control.ForeColor.md")|Returns/sets the foreground color used to display text and graphics in an object (Windows, Web).|
|[`Grouped`]("Control.Grouped.md")|Returns/sets the value indicating the first control of a group of controls (Windows only).|
|[`Handle`]("Component.Handle.md")|Gets the window handle that the control is bound to (Windows, Linux, Android, Web).|
|[`Height`]("Component.Height.md")|Returns/sets the height of an object (Windows, Linux, Android, Web).|
|[`HelpContext`]("Control.HelpContext.md")|Specifies the default Help file context ID for an object (Windows only).|
|[`Hint`]("Control.Hint.md")|Returns/sets the text displayed when the mouse is paused over the control (Windows, Linux).|
|[`HoverTime`]("Control.HoverTime.md")|Determines the time interval, after which the element, over which the mouse cursor hovers, is highlighted (Windows, Linux).|
|[`ID`]("Control.ID.md")|Gets or sets the programmatic identifier assigned to the control (Windows, Android).|
|[`IsChild`]("Control.IsChild.md")|Determines whether a window is a child window or descendant window of a specified parent window (Windows, Linux).|
|[`LayoutHandle`]("Component.LayoutHandle.md")||
|[`Left`]("Component.Left.md")|Returns/sets the distance between the internal left edge of an object and the left edge of its container (Windows, Linux, Android, Web).|
|[`Location`]("Control.Location.md")|Returns/sets the coordinates of the upper-left corner of the control relative to the upper-left corner of its container (Windows, Linux, Android, Web).|
|[`Margins`]("Component.Margins.md")|Returns/sets the space between controls (Windows, Linux, Android, Web).|
|[`Name`]("Component.Name.md")|Returns the name used in code to identify an object (Windows, Linux, Android, Web).|
|[`Parent`]("Control.Parent.md")|Returns/sets the parent container of the control (Windows, Linux, Android, Web).|
|[`ShowCaption`]("Control.ShowCaption.md")|Returns/sets the value indicating show Caption. (Windows only).|
|[`ShowHint`]("Control.ShowHint.md")|Returns/sets the value indicating show hint (Windows, Linux).|
|[`Size`]("Control.Size.md")|Returns/sets the height and width of the control (Windows, Linux, Android, Web).|
|[`SubClass`]("Control.SubClass.md")|Returs/sets a value indicating type is subclass or not (Windows only).|
|[`TabIndex`]("ScrollControl.TabIndex.md")||
|[`TabStop`]("ScrollControl.TabStop.md")||
|[`Tag`]("Component.Tag.md")|Stores any extra data needed for your program (Windows, Linux, Android, Web).|
|[`Text`]("Control.Text.md")|Returns/sets the text contained in the control (Windows, Linux, Android, Web).|
|[`Top`]("Component.Top.md")|Returns/sets the distance between the internal top edge of an object and the top edge of its container (Windows, Linux, Android, Web).|
|[`Visible`]("ContainerControl.Visible.md")|Returns/sets a value that determines whether an object is visible or hidden (Windows, Linux, Web).|
|[`Width`]("Component.Width.md")|Returns/sets the width of an object (Windows, Linux, Android, Web).|
|[`xdpi`]("My.Sys.Object.xdpi.md")|Horizontal DPI scaling factor (Windows, Linux, Android, Web).|
|[`ydpi`]("My.Sys.Object.ydpi.md")|Vertical DPI scaling factor (Windows, Linux, Android, Web).|

## Methods
|Name|Description|
| :------------ | :------------ |
|[`Add`]("ScrollControl.Add.md")||
|[`AddRange`]("Control.AddRange.md")|Adds the specified controls range to the control collection (Windows, Linux, Android, Web).|
|[`BringToFront`]("Control.BringToFront.md")|Brings the control to the front of the z-order (Windows, Linux).|
|[`ClassAncestor`]("Component.ClassAncestor.md")|Returns ancestor class of control (Windows, Linux, Android, Web).|
|[`ClassName`]("My.Sys.Object.ClassName.md")|Used to get correct class name of the object (Windows, Linux, Android, Web).|
|[`ClientHeight`]("Control.ClientHeight.md")|Returns/sets the height of the client area of the control (Windows, Linux, Android, Web).|
|[`ClientToScreen`]("Control.ClientToScreen.md")|Converts the client-area coordinates of a specified point to screen coordinates (Windows only).|
|[`ClientWidth`]("Control.ClientWidth.md")|Returns/sets the width of the client area of the control (Windows, Linux, Android, Web).|
|[`ControlByName`]("Control.ControlByName.md")|Retrieves the Control object from Control name in the collection (Windows, Linux, Android, Web).|
|[`ControlCount`]("Control.ControlCount.md")|Gets the number of controls in the Control collection (Windows, Linux, Android, Web).|
|[`CreateWnd`]("Control.CreateWnd.md")|Creates the window (Windows, Android, Web)|
|[`Focused`]("Control.Focused.md")|Returns a value indicating whether the control has input focus (Windows, Linux).|
|[`FreeWnd`]("Control.FreeWnd.md")|Destroys the specified window handle (Windows, Linux).|
|[`FullTypeName`]("My.Sys.Object.FullTypeName.md")|Function to get any typename in the inheritance up hierarchy of the type of an instance (address: 'po') compatible with the built-in 'Object' <br>  ('baseIndex =  0' to get the typename of the instance) <br>  ('baseIndex = -1' to get the base.typename of the instance, or "" if not existing) <br>  ('baseIndex = -2' to get the base.base.typename of the instance, or "" if not existing)|
|[`GetBounds`]("Component.GetBounds.md")|Gets the bounds of the control to the specified location and size (Windows, Linux, Android, Web).|
|[`GetForm`]("Control.GetForm.md")|Retrieves the form that the control is on (Windows, Linux, Android, Web).|
|[`GetTextLength`]("Control.GetTextLength.md")|Determines the length, in characters, of the text associated with a window (Windows, Linux, Android, Web).|
|[`GetTopLevel`]("Component.GetTopLevel.md")|Determines if the control is a top-level control (Windows, Linux, Android, Web).|
|[`Hide`]("Control.Hide.md")|Conceals the control from the user (Windows, Linux, Android, Web).|
|[`IndexOf`]("Control.IndexOf.md")|Retrieves the index of a specified Control object in the collection (Windows, Linux, Android, Web).|
|[`Invalidate`]("Control.Invalidate.md")|Invalidates the entire surface of the control and causes the control to be redrawn (Windows only).|
|[`IsEmpty`]("My.Sys.Object.IsEmpty.md")|Returns a Boolean value indicating whether a object has been initialized (Windows, Linux, Android, Web).|
|[`ProcessMessage`]("Control.ProcessMessage.md")||
|[`ReadProperty`]("ScrollControl.ReadProperty.md")||
|[`RecalculateScrollBars`]("ScrollControl.RecalculateScrollBars.md")||
|[`RecreateWnd`]("Control.RecreateWnd.md")|Recreates the window (Windows only)|
|[`RegisterClass`]("ContainerControl.RegisterClass.md")|Function registers a window class for subsequent use in calls to the create window (Windows, Linux)|
|[`Remove`]("Control.Remove.md")|Removes the specified control from the control collection (Windows, Linux, Android, Web).|
|[`Repaint`]("Control.Repaint.md")|Forces the control to invalidate its client area and immediately redraw itself and any child controls (Windows, Linux).|
|[`RequestAlign`]("Control.RequestAlign.md")|Instructs the parent of a control to reposition the control, enforcing its Align property (Windows, Linux, Android, Web).|
|[`ScaleX`]("My.Sys.Object.ScaleX.md")|Applies horizontal DPI scaling|
|[`ScaleY`]("My.Sys.Object.ScaleY.md")|Applies vertical DPI scaling|
|[`ScreenToClient`]("Control.ScreenToClient.md")|Converts the screen coordinates of a specified point on the screen to client coordinates (Windows only).|
|[`SelectNextControl`]("Control.SelectNextControl.md")|Activates the next control (Windows only).|
|[`SendToBack`]("Control.SendToBack.md")|Sends the control to the back of the z-order (Windows, Linux).|
|[`SetBounds`]("Component.SetBounds.md")|Sets the bounds of the control to the specified location and size (Windows, Linux, Android, Web).|
|[`SetFocus`]("Control.SetFocus.md")|Moves the focus to the specified form or the specified control on the active form (Windows, Linux).|
|[`SetMargins`]("Control.SetMargins.md")|Sets the left, top, right, bottom margins for a container control (Windows, Linux, Android, Web).|
|[`Show`]("Control.Show.md")|Displays the control to the user (Windows, Linux, Android, Web).|
|[`TopLevelControl`]("Control.TopLevelControl.md")|Returns the parent control that is not parented by another Forms control. Typically, this is the outermost Form that the control is contained in (Windows, Linux, Android, Web).|
|[`ToString`]("Component.ToString.md")|Returns a string that represents the current object (Windows, Linux, Android, Web).|
|[`UnScaleX`]("My.Sys.Object.UnScaleX.md")|Reverses horizontal scaling|
|[`UnScaleY`]("My.Sys.Object.UnScaleY.md")|Reverses vertical scaling|
|[`Update`]("Control.Update.md")|Causes the control to redraw the invalidated regions within its client area (Windows, Linux).|
|[`UpdateLock`]("Control.UpdateLock.md")|Disables drawing in the specified window (Windows only).|
|[`UpdateUnLock`]("Control.UpdateUnLock.md")|Enables drawing in the specified window (Windows only).|
|[`WriteProperty`]("ScrollControl.WriteProperty.md")||
## Events
|Name|Description|
| :------------ | :------------ |
|[`OnClick`]("Control.OnClick.md") |Occurs when the control is clicked (Windows, Linux, Android, Web).|
|[`OnCreate`]("Control.OnCreate.md") |Occurs when the control is created (Windows, Linux, Android, Web).|
|[`OnDblClick`]("Control.OnDblClick.md") |Occurs when the control is double-clicked (Windows, Linux, Web).|
|[`OnDestroy`]("Control.OnDestroy.md") |Occurs when the control's handle is in the process of being destroyed (Windows, Linux, Android, Web).|
|[`OnDropFile`]("Control.OnDropFile.md") |Occurs when the user drops a file on the window of an application that has registered itself as a recipient of dropped files (Windows, Linux).|
|[`OnGotFocus`]("Control.OnGotFocus.md") |Occurs when the control receives focus (Windows, Linux, Web).|
|[`OnKeyDown`]("Control.OnKeyDown.md") |Occurs when a key is pressed while the control has focus (Windows, Linux, Web).|
|[`OnKeyPress`]("Control.OnKeyPress.md") |Occurs when a character. space or backspace key is pressed while the control has focus (Windows, Linux, Web).|
|[`OnKeyUp`]("Control.OnKeyUp.md") |Occurs when a key is released while the control has focus (Windows, Linux, Web).|
|[`OnLostFocus`]("Control.OnLostFocus.md") |Occurs when the control loses focus (Windows, Linux, Web).|
|[`OnMessage`]("Control.OnMessage.md") |Occurs when the window receives a message (Windows, Linux).|
|[`OnMouseDown`]("Control.OnMouseDown.md") |Occurs when the mouse pointer is over the control and a mouse button is pressed (Windows, Linux, Web).|
|[`OnMouseEnter`]("Control.OnMouseEnter.md") |Occurs when the mouse pointer enters the control (Windows, Linux, Web).|
|[`OnMouseHover`]("Control.OnMouseHover.md") |Occurs when the mouse pointer rests on the control (Windows only).|
|[`OnMouseLeave`]("Control.OnMouseLeave.md") |Occurs when the mouse pointer leaves the control (Windows, Linux, Web).|
|[`OnMouseMove`]("Control.OnMouseMove.md") |Occurs when the mouse pointer is moved over the control (Windows, Linux, Web).|
|[`OnMouseUp`]("Control.OnMouseUp.md") |Occurs when the mouse pointer is over the control and a mouse button is released (Windows, Linux, Web).|
|[`OnMouseWheel`]("Control.OnMouseWheel.md") |Occurs when the mouse wheel moves while the control has focus (Windows, Linux, Web).|
|[`OnMove`]("Control.OnMove.md") |Occurs when the control is moved (Windows, Linux).|
|[`OnPaint`]("Control.OnPaint.md") |Occurs when the control is redrawn (Windows, Linux).|
|[`OnResize`]("Control.OnResize.md") |Occurs when the control is resized (Windows, Linux, Android).|
|[`OnScroll`]("ScrollControl.OnScroll.md") ||
## Examples
```freeBasic
'################################################################################
'#  ScrollControl Example.frm                                                              #
'#  This file is an examples of MyFBFramework.                                  #
'#  Authors: Xusinboy Bekchanov, Liu XiaLin                                     #
'################################################################################

	'\#Region "Form"
	\#if defined(__FB_MAIN__) AndAlso Not defined(__MAIN_FILE__)
		\#define __MAIN_FILE__
		\#ifdef __FB_WIN32__
			\#cmdline "Form1.rc"
		\#endif
		Const _MAIN_FILE_ = __FILE__
	\#endif
	
	\#include once "mff/Form.bi"
	\#include once "mff/Picture.bi"
	\#include once "mff/Label.bi"
	
	\#include once "mff/ScrollControl.bi"
	\#include once "mff/CommandButton.bi"
	\#include once "mff/TrackBar.bi"
	\#include once "mff/TimerComponent.bi"
	\#include once "mff/NumericUpDown.bi"
	\#include once "mff/UpDown.bi"
	\#include once "maze.bi"
	Using My.Sys.Forms

	Dim Shared As Maze aMaze
	Dim Shared As Integer MazeX, MazeY
	Dim Shared As Boolean Ending, Playing = True
	' Adjust speed here
	Dim Shared As Long speed = 160 ' Frames Per Second
	' Adjust speed here
	Dim Shared As Long fps
	
	Type Form1Type Extends Form
		Declare Sub Form_Resize(ByRef Sender As Control, NewWidth As Integer, NewHeight As Integer)
		Declare Sub Form_Create(ByRef Sender As Control)
		Declare Sub Form_Close(ByRef Sender As Form, ByRef Action As Integer)
		Declare Sub PanelRender_Resize(ByRef Sender As Control, NewWidth As Integer, NewHeight As Integer)
		Declare Sub cmdPlay_Click(ByRef Sender As Control)
		Declare Sub cmdRefresh_Click(ByRef Sender As Control)
		Declare Sub TrackBarFPS_Change(ByRef Sender As TrackBar, Position As Integer)
		Declare Sub Form_Paint(ByRef Sender As Control, ByRef Canvas As My.Sys.Drawing.Canvas)
		Declare Sub PanelRender_Paint(ByRef Sender As Control, ByRef Canvas As My.Sys.Drawing.Canvas)
		Declare Sub TimerFPS_Timer(ByRef Sender As TimerComponent)
		Declare Sub Form_Show(ByRef Sender As Form)
		Declare Sub NumUpDnWallSize_KeyPress(ByRef Sender As Control, Key As Integer)
		Declare Sub NumUpDnMazeSize_KeyPress(ByRef Sender As Control, Key As Integer)
		Declare Sub ScrollMaze_Scroll(ByRef Sender As ScrollControl)
		Declare Constructor
		
		Dim As Picture PanelRender
		Dim As ScrollControl ScrollMaze
		Dim As Label lblFPS, lblLanguage, lblMazeSize, lblWallSize ', lblPosition
		Dim As CommandButton cmdRefresh, cmdPlay
		Dim As TrackBar TrackBarFPS
		Dim As TimerComponent TimerFPS
		Dim As NumericUpDown NumUpDnMazeSize, NumUpDnWallSize
		
	End Type
	
	Constructor Form1Type
		\#if _MAIN_FILE_ = __FILE__
			With App
				.CurLanguagePath = ExePath & "/"
				.CurLanguage = .Language  '"Chinese (Simplified)"
			End With
		\#endif
		' Form1
		With This
			.Name = "Form1"
			.Text = "VisualFBEditor-Maze"
			.Designer = @This
			.StartPosition = FormStartPosition.CenterScreen
			.OnResize = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As Control, NewWidth As Integer, NewHeight As Integer), @Form_Resize)
			.OnCreate = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As Control), @Form_Create)
			.OnClose = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As Form, ByRef Action As Integer), @Form_Close)
			.OnPaint = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As Control, ByRef Canvas As My.Sys.Drawing.Canvas), @Form_Paint)
			.OnShow = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As Form), @Form_Show)
			.SetBounds 0, 0, 620, 450
		End With
		
		' PanelRender
		With PanelRender
			.Name = "PanelRender"
			.Text = "PanelRender"
			.TabIndex = 2
			.BackColor = 8421376
			.DoubleBuffered = True
			'.Anchor.Top = AnchorStyle.asAnchor
			'.Anchor.Right = AnchorStyle.asAnchor
			'.Anchor.Left = AnchorStyle.asAnchor
			'.Anchor.Bottom = AnchorStyle.asAnchor
			.SetBounds 0, 10, 310, 240
			.Designer = @This
			.OnResize = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As Control, NewWidth As Integer, NewHeight As Integer), @PanelRender_Resize)
			.OnPaint = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As Control, ByRef Canvas As My.Sys.Drawing.Canvas), @PanelRender_Paint)
			.Parent = @ScrollMaze
		End With
		' lblFPS
		With lblFPS
			.Name = "lblFPS"
			.Text = "FPS："
			.TabIndex = 1
			.SetBounds 10, 40, 70, 20
			.Designer = @This
			.Parent = @This
		End With
		' cmdRefresh
		With cmdRefresh
			.Name = "cmdRefresh"
			.Text = ML("Refresh")
			.TabIndex = 2
			.SetBounds 20, 70, 60, 20
			.Designer = @This
			.OnClick = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As Control), @cmdRefresh_Click)
			.Parent = @This
		End With
		' cmdPlay
		With cmdPlay
			.Name = "cmdPlay"
			.Text = ML("Play")
			.TabIndex = 3
			.ControlIndex = 2
			.Visible = False
			.SetBounds 20, 100, 60, 20
			.Enabled = False
			.Designer = @This
			.OnClick = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As Control), @cmdPlay_Click)
			.Parent = @This
		End With
		' TrackBarFPS
		With TrackBarFPS
			.Name = "TrackBarFPS"
			.Text = "TrackBarFPS"
			.TabIndex = 4
			.ControlIndex = 4
			.Hint = ML("change the FPS")
			.MaxValue = 255
			.MinValue = 10
			.Position = speed
			.SetBounds 8, 55, 77, 10
			.Designer = @This
			.OnChange = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As TrackBar, Position As Integer), @TrackBarFPS_Change)
			.Parent = @This
		End With
		' lblLanguage
		With lblLanguage
			.Name = "lblLanguage"
			.Text = ML("Language:") & App.CurLanguage
			.TabIndex = 5
			.ControlIndex = 1
			.SetBounds 10, 0, 100, 40
			.Designer = @This
			.Parent = @This
		End With
		
		' TimerFPS
		With TimerFPS
			.Name = "TimerFPS"
			.Interval = 50
			.Enabled = True
			.SetBounds 20, 200, 16, 16
			.Designer = @This
			.OnTimer = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As TimerComponent), @TimerFPS_Timer)
			.Parent = @This
		End With
		' lblMazeSize
		With lblMazeSize
			.Name = "lblMazeSize"
			.Text = ML("Maze Size:")
			.TabIndex = 6
			.SetBounds 10, 130, 60, 20
			.Designer = @This
			.Parent = @This
		End With
		' NumUpDnMazeSize
		With NumUpDnMazeSize
			.Name = "NumUpDnMazeSize"
			.Text = "20"
			.TabIndex = 8
			.MaxValue = 10
			.MinValue = 100
			.SetBounds 70, 130, 40, 20
			.Designer = @This
			.OnKeyPress = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As Control, Key As Integer), @NumUpDnMazeSize_KeyPress)
			.Parent = @This
		End With
		' lblWallSize
		With lblWallSize
			.Name = "lblWallSize"
			.Text = ML("Wall Size:")
			.TabIndex = 9
			.ControlIndex = 6
			.SetBounds 10, 160, 60, 20
			.Designer = @This
			.Parent = @This
		End With
		' NumUpDnWallSize
		With NumUpDnWallSize
			.Name = "NumUpDnWallSize"
			.Text = "0"
			.TabIndex = 11
			.ControlIndex = 8
			.MaxValue = 10
			.MinValue = 100
			.SetBounds 70, 160, 40, 20
			.Designer = @This
			.OnKeyPress = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As Control, Key As Integer), @NumUpDnWallSize_KeyPress)
			.Parent = @This
		End With
		
			' ScrollMaze
		With ScrollMaze
			.Name = "ScrollMaze"
			.Text = "ScrollMaze"
			.TabIndex = 14
			.Anchor.Top = AnchorStyle.asAnchor
			.Anchor.Right = AnchorStyle.asAnchor
			.Anchor.Left = AnchorStyle.asAnchor
			.Anchor.Bottom = AnchorStyle.asAnchor
			.SetBounds 120, 10, 479, 390
			.Designer = @This
			.OnScroll = Cast(Sub(ByRef Designer As My.Sys.Object, ByRef Sender As ScrollControl), @ScrollMaze_Scroll)
			.Parent = @This
		End With
	'
	'	' lblPosition
	'	With lblPosition
	'		.Name = "lblPosition"
	'		.Text = "VisualFBEditor"
	'		.TabIndex = 13
	'		.SetBounds 360, 380, 260, 120
	'		.Designer = @This
	'		.Parent = @ScrollMaze
	'	End With
	End Constructor
	
	Dim Shared Form1 As Form1Type
	
	\#if _MAIN_FILE_ = __FILE__
		App.DarkMode = True
		Form1.MainForm = True
		Form1.Show
		App.Run
	\#endif
	'\#End Region

Function regulate(ByVal myfps As Long, ByRef fps As Long) As Long
	Static As Double timervalue, _lastsleeptime, t3, frames
	frames += 1
	If (Timer - t3) >= 1 Then t3 = Timer : fps = frames : frames = 0
	Var sleeptime = _lastsleeptime + ((1 / myfps) - Timer + timervalue) * 1000
	If sleeptime < 1 Then sleeptime = 1
	_lastsleeptime = sleeptime
	timervalue = Timer
	Return sleeptime
End Function

'the main rendering code.  渲染代码主过程。
Sub RenderProj(Param As Any Ptr)
	
End Sub

Private Sub Form1Type.Form_Create(ByRef Sender As Control)
	
End Sub

Private Sub Form1Type.Form_Resize(ByRef Sender As Control, NewWidth As Integer, NewHeight As Integer)
	
End Sub


Private Sub Form1Type.Form_Close(ByRef Sender As Form, ByRef Action As Integer)
	Ending = True
End Sub

Private Sub Form1Type.PanelRender_Resize(ByRef Sender As Control, NewWidth As Integer, NewHeight As Integer)
	
End Sub

Private Sub Form1Type.cmdPlay_Click(ByRef Sender As Control)
	Playing = True
	cmdPlay.Enabled = Not Playing
	cmdRefresh.Enabled = Playing
	If Playing Then RenderProj(0)
	TimerFPS.Enabled = Playing
	'aMaze.Show(Val(NumUpDnWallSize.Text))
	
End Sub

Private Sub Form1Type.cmdRefresh_Click(ByRef Sender As Control)
	'Playing = False
	'cmdPlay.Enabled = Not Playing
	'cmdRefresh.Enabled = Playing
	'If Playing Then RenderProj(0)
	cmdRefresh.Enabled = False
	PanelRender.Width = (Val(NumUpDnMazeSize.Text) + 1) * Val(NumUpDnWallSize.Text): PanelRender.Height = PanelRender.Width
	'lblPosition.Left = PanelRender.Width + 20 : lblPosition.Top = PanelRender.Height + 20
	TimerFPS.Enabled = Playing
	MazeX = 0 : MazeY = 0
	aMaze.Init(Val(NumUpDnMazeSize.Text), Val(NumUpDnWallSize.Text))
	ScrollMaze.RecalculateScrollBars
	PanelRender.Repaint
	cmdRefresh.Enabled = True
End Sub

Private Sub Form1Type.TrackBarFPS_Change(ByRef Sender As TrackBar, Position As Integer)
	If Sender.Position < 10 Then Sender.Position = 10
	speed = Sender.Position
	lblFPS.Text = "FPS:" & speed
End Sub

Private Sub Form1Type.Form_Paint(ByRef Sender As Control, ByRef Canvas As My.Sys.Drawing.Canvas)
	
End Sub

Private Sub Form1Type.PanelRender_Paint(ByRef Sender As Control, ByRef Canvas As My.Sys.Drawing.Canvas)
	Dim As Integer x, y, xx, yy, ws
	ws = aMaze.WallSize / 2
	Debug.Print "aMaze.WallSize=" & aMaze.WallSize
	Debug.Print "aMaze.MazeSize=" & aMaze.MazeSize
	'Canvas.Scale(0, 0, (aMaze.MazeSize+ 1) * aMaze.WallSize / 2, (aMaze.MazeSize+ 1) * aMaze.WallSize/ 2)
	Canvas.Cls
	For x = 0 To aMaze.MazeSize -1
		For y = 0 To aMaze.MazeSize -1
			xx = x*aMaze.WallSize + aMaze.WallSize
			yy = y*aMaze.WallSize + aMaze.WallSize
			If aMaze.rooms(x, y).getStatus() And (Gen Or Visited) Then
				'Canvas.Line(xx - ws, yy - ws, xx + ws, yy + ws, RGB(0, 32, 0), "bf")
				If aMaze.rooms(x, y).getStatus() And Gen Then Canvas.Circle(xx, yy, ws / 2, RGB(255, 128, 0))
				If aMaze.rooms(x, y).isWall(North) And WALL Then Canvas.Line (xx - ws, yy - ws, xx + ws, yy - ws, RGB(0, 255, 0))
				If aMaze.rooms(x, y).isWall(West)  And WALL Then Canvas.Line (xx - ws, yy - ws, xx - ws, yy + ws, RGB(0, 255, 0))
				If aMaze.rooms(x, y).isWall(South) And WALL Then Canvas.Line (xx - ws, yy + ws, xx + ws, yy + ws, RGB(0, 255, 0))
				If aMaze.rooms(x, y).isWall(East)  And WALL Then Canvas.Line (xx + ws, yy - ws, xx + ws, yy + ws, RGB(0, 255, 0))
			End If
		Next
	Next
	'Draw entry
	x = 0: y = 0
    xx = x*aMaze.WallSize + aMaze.WallSize
	yy = y*aMaze.WallSize + aMaze.WallSize
	'Canvas.Line(xx - ws * 1.1, yy - ws * 0.7, xx - ws *.9, yy + ws *.8, PanelRender.BackColor) ', "bf")
	Canvas.Line (xx - ws, yy - ws, xx - ws, yy + ws, PanelRender.BackColor)
	Canvas.TextOut(xx - ws *.8, yy - ws *.8, "->")
	
	'Draw Exit
	x = aMaze.MazeSize -1: y = aMaze.MazeSize -1
    xx = x*aMaze.WallSize + aMaze.WallSize
	yy = y*aMaze.WallSize + aMaze.WallSize
	'Canvas.Line(xx + ws *.9, yy - ws * 0.7, xx + ws * 1.1, yy + ws *.8, PanelRender.BackColor) ', "bf")
	Canvas.Line (xx + ws, yy - ws, xx + ws, yy + ws, PanelRender.BackColor)
	Canvas.TextOut(xx - ws * 0.2, yy - ws *.8, "->")
	'
	'Exit Sub
	'For x = 0 To aMaze.MazeSize -1
	'	For y = 0 To aMaze.MazeSize -1
	'		xx = x * aMaze.WallSize + aMaze.WallSize
	'		yy = y * aMaze.WallSize + aMaze.WallSize
	'		If aMaze.rooms(x,y).getStatus() And (Gen Or Visited) Then
	'		Else
	'			Canvas.Line(xx - ws, yy - ws, xx + ws, yy + ws, RGB(0, 64, 0), "bf")
	'		End If
	'	Next
	'Next
End Sub

Private Sub Form1Type.TimerFPS_Timer(ByRef Sender As TimerComponent)
	
	'App.DoEvents
	If MazeY > aMaze.MazeSize- 1 Then
		MazeX += 1
		MazeY = 0
	End If
	'PanelRender.Repaint
	MazeY += 1
	Sleep regulate(speed, fps), 1
	
End Sub

Private Sub Form1Type.Form_Show(ByRef Sender As Form)
	cmdRefresh_Click(Sender)
End Sub

Private Sub Form1Type.NumUpDnWallSize_KeyPress(ByRef Sender As Control, Key As Integer)
	If Key = 13 Then cmdRefresh_Click(Sender)
End Sub

Private Sub Form1Type.NumUpDnMazeSize_KeyPress(ByRef Sender As Control, Key As Integer)
	If Key = 13 Then cmdRefresh_Click(Sender)
End Sub

Private Sub Form1Type.ScrollMaze_Scroll(ByRef Sender As ScrollControl)
	Print "PanelRender.ClientWidth=" & PanelRender.ClientWidth & ", PanelRender.ClientHeight=" & PanelRender.ClientHeight
	Print " ScrollMaze.ClientWidth=" & Sender.ClientWidth & ",       ScrollMaze.ClientHeight=" & Sender.ClientHeight
End Sub

```
## See also
Namespace: [`My.Sys.Forms`](My.Sys.Forms.md)
